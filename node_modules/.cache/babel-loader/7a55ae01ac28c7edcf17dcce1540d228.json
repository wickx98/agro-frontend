{"ast":null,"code":"import _slicedToArray from\"C:/Users/hasit/Desktop/Project new new/web-cw-main/web-cw-main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useEffect,useRef}from'react';import{Form,Button,Row,Col,Container,Table,Image,Overlay,Popover}from'react-bootstrap';import{Scrollbar}from\"react-scrollbars-custom\";import{LinkContainer}from'react-router-bootstrap';import{useDispatch,useSelector}from'react-redux';import Message from'./../../components/Message/Message';import Loader from'./../../components/Loader/Loader';import{getUserDetails,updateUserProfile}from'../../actions/userActions';import{listMyOrders}from'./../../actions/orderAction';import{listMyProducts}from'./../../actions/supplierProduct';import Meta from'../../components/Helmet/Meta';var ProfileScreen=function ProfileScreen(_ref){var history=_ref.history;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),target=_useState4[0],setTarget=_useState4[1];var ref=useRef(null);var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),email=_useState8[0],setEmail=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),password=_useState10[0],setPassword=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),cropSelection=_useState12[0],setCropSelection=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),confirmPassword=_useState14[0],setConfirmPassword=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),message=_useState16[0],setMessage=_useState16[1];var dispatch=useDispatch();var userDetails=useSelector(function(state){return state.userDetails;});var loading=userDetails.loading,user=userDetails.user,error=userDetails.error;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userUpdateProfile=useSelector(function(state){return state.userUpdateProfile;});var success=userUpdateProfile.success;var orderListMy=useSelector(function(state){return state.orderListMy;});var loadingOrders=orderListMy.loading,errorOrders=orderListMy.error,orders=orderListMy.orders;var supplierProdictListMy=useSelector(function(state){return state.supplierProdictListMy;});var loadingProducts=supplierProdictListMy.loading,errorProducts=supplierProdictListMy.error,products=supplierProdictListMy.products;useEffect(function(){if(!userInfo){history.push('/login');}else{if(!user.name){dispatch(getUserDetails('profile'));dispatch(listMyOrders());dispatch(listMyProducts());}else{setName(user.name);setEmail(user.email);setCropSelection(user.cropSelection);}}},[userInfo,history,user,dispatch]);var submitHandler=function submitHandler(e){e.preventDefault();if(password!==confirmPassword){setMessage('Passwords do not match');}else{dispatch(updateUserProfile({id:user._id,name:name,email:email,password:password,cropSelection:cropSelection}));}};var handleClick=function handleClick(event){setShow(!show);setTarget(event.target);};return/*#__PURE__*/_jsxs(Container,{fluid:true,style:{marginBottom:'50px'},children:[/*#__PURE__*/_jsx(Meta,{title:\"Agrocare | Profile\"}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:'110px'},children:\"User Profile\"}),message&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:message}),error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}),success&&/*#__PURE__*/_jsx(Message,{variant:\"success\",children:\"Profile Updated!\"}),loading&&/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[\"Name \",/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"*\"})]}),/*#__PURE__*/_jsx(Form.Control,{type:\"name\",placeholder:\"Enter name\",value:name,required:true,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"email\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[\"Email Address / NIC \",/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"*\"})]}),/*#__PURE__*/_jsx(Form.Control,{type:\"nic\",placeholder:\"Enter email or NIC\",value:email,required:true,onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"cropSelection\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Crop Selection (optional)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"cropSelection\",placeholder:\"Enter cropSelection\",value:cropSelection,onChange:function onChange(e){return setCropSelection(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Enter password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"confirmPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Confirm password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Confirm password\",value:confirmPassword,onChange:function onChange(e){return setConfirmPassword(e.target.value);}})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Update\"})]})]}),/*#__PURE__*/_jsx(Col,{md:9,children:/*#__PURE__*/_jsx(Scrollbar,{style:{width:'100%',height:630},children:/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:'110px'},children:\"My Orders\"}),loadingOrders?/*#__PURE__*/_jsx(Loader,{}):errorOrders?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorOrders}):/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,responsive:true,className:\"table-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"DATE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"TOTAL\"}),/*#__PURE__*/_jsx(\"th\",{children:\"PAID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"DELIVERED\"}),/*#__PURE__*/_jsx(\"th\",{children:\"MORE\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:order.createdAt.substring(0,10)}),/*#__PURE__*/_jsx(\"td\",{children:order.totalPrice}),/*#__PURE__*/_jsx(\"td\",{children:order.isPaid?order.paidAt.substring(0,10):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",styles:{color:\"red\"}})}),/*#__PURE__*/_jsx(\"td\",{children:order.isDelivered?order.deliveredAt.substring(0,10):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",styles:{color:'red'}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(LinkContainer,{to:\"/order/\".concat(order._id),children:/*#__PURE__*/_jsx(Button,{className:\"btn-sm\",variant:\"success\",children:\"Details\"})})})]},order._id);})})]})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:'110px'},children:\"My Products\"}),loadingProducts?/*#__PURE__*/_jsx(Loader,{}):errorProducts?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorProducts}):/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,responsive:true,className:\"table-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"NAME\"}),/*#__PURE__*/_jsx(\"th\",{children:\"EMAIL/NIC\"}),/*#__PURE__*/_jsx(\"th\",{children:\"ADDRESS\"}),/*#__PURE__*/_jsx(\"th\",{children:\"IMAGE\"}),/*#__PURE__*/_jsx(\"th\",{children:\"CROP\"}),/*#__PURE__*/_jsx(\"th\",{children:\"REVIEWED\"}),/*#__PURE__*/_jsx(\"th\",{children:\"EDIT\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:products.map(function(product){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:product.name}),/*#__PURE__*/_jsx(\"td\",{children:product.email}),/*#__PURE__*/_jsx(\"td\",{children:product.address}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Image,{width:70,rounded:true,src:product.image})}),/*#__PURE__*/_jsx(\"td\",{children:product.cropSelection}),/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"center\"},children:[product.isReviwed?/*#__PURE__*/_jsx(Button,{className:\"mt-2\",ref:target,onClick:handleClick,children:\" Check\"}):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",style:{color:'red',fontSize:'24px'}}),/*#__PURE__*/_jsx(Overlay,{show:show,target:target,placement:\"bottom\",container:ref.current,containerPadding:10,children:/*#__PURE__*/_jsxs(Popover,{id:\"popover-contained\",children:[/*#__PURE__*/_jsxs(Popover.Title,{as:\"h3\",children:[\"Rating: \",product.rating]}),product.reviews.map(function(review){return/*#__PURE__*/_jsx(Popover.Content,{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"Feedback: \",review.comment]})},review._id);})]})})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(LinkContainer,{to:\"/supplierproducts/\".concat(product._id,\"/edit\"),children:/*#__PURE__*/_jsx(Button,{variant:\"light\",className:\"btn btn-sm\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"})})})})]},product._id);})})]})]})]})})})]})]});};export default ProfileScreen;","map":{"version":3,"sources":["C:/Users/hasit/Desktop/Project new new/web-cw-main/web-cw-main/frontend/src/screens/Profile/ProfileScreen.jsx"],"names":["React","useState","useEffect","useRef","Form","Button","Row","Col","Container","Table","Image","Overlay","Popover","Scrollbar","LinkContainer","useDispatch","useSelector","Message","Loader","getUserDetails","updateUserProfile","listMyOrders","listMyProducts","Meta","ProfileScreen","history","show","setShow","target","setTarget","ref","name","setName","email","setEmail","password","setPassword","cropSelection","setCropSelection","confirmPassword","setConfirmPassword","message","setMessage","dispatch","userDetails","state","loading","user","error","userLogin","userInfo","userUpdateProfile","success","orderListMy","loadingOrders","errorOrders","orders","supplierProdictListMy","loadingProducts","errorProducts","products","push","submitHandler","e","preventDefault","id","_id","handleClick","event","marginBottom","marginTop","color","value","width","height","map","order","createdAt","substring","totalPrice","isPaid","paidAt","isDelivered","deliveredAt","product","address","image","textAlign","isReviwed","fontSize","current","rating","reviews","review","comment"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport {\n    Form,\n    Button,\n    Row,\n    Col,\n    Container,\n    Table,\n    Image,\n    Overlay,\n    Popover\n} from 'react-bootstrap'\nimport { Scrollbar } from \"react-scrollbars-custom\";\nimport { LinkContainer } from 'react-router-bootstrap'\nimport { useDispatch, useSelector } from 'react-redux'\nimport Message from './../../components/Message/Message'\nimport Loader from './../../components/Loader/Loader'\nimport { getUserDetails, updateUserProfile } from '../../actions/userActions'\nimport { listMyOrders } from './../../actions/orderAction'\nimport { listMyProducts } from './../../actions/supplierProduct'\nimport Meta from '../../components/Helmet/Meta';\n\nconst ProfileScreen = ({ history }) => {\n\n    const [show, setShow] = useState(false);\n    const [target, setTarget] = useState(null);\n    const ref = useRef(null);\n\n    const [name, setName] = useState('')\n    const [email, setEmail] = useState('')\n    const [password, setPassword] = useState('')\n    const [cropSelection, setCropSelection] = useState('')\n    const [confirmPassword, setConfirmPassword] = useState('')\n    const [message, setMessage] = useState(null)\n\n    const dispatch = useDispatch()\n\n    const userDetails = useSelector(state => state.userDetails)\n    const { loading, user, error } = userDetails\n\n    const userLogin = useSelector(state => state.userLogin)\n    const { userInfo } = userLogin\n\n    const userUpdateProfile = useSelector(state => state.userUpdateProfile)\n    const { success } = userUpdateProfile\n\n    const orderListMy = useSelector(state => state.orderListMy)\n    const { loading: loadingOrders, error: errorOrders, orders } = orderListMy\n\n    const supplierProdictListMy = useSelector(state => state.supplierProdictListMy)\n    const { loading: loadingProducts, error: errorProducts, products } = supplierProdictListMy\n\n    useEffect(() => {\n        if (!userInfo) {\n            history.push('/login')\n        } else {\n            if (!user.name) {\n                dispatch(getUserDetails('profile'))\n                dispatch(listMyOrders())\n                dispatch(listMyProducts())\n            } else {\n                setName(user.name)\n                setEmail(user.email)\n                setCropSelection(user.cropSelection)\n            }\n        }\n    }, [userInfo, history, user, dispatch])\n\n    const submitHandler = (e) => {\n        e.preventDefault()\n        if (password !== confirmPassword) {\n            setMessage('Passwords do not match')\n        } else {\n            dispatch(updateUserProfile({ id: user._id, name, email, password, cropSelection }))\n        }\n    }\n\n    const handleClick = (event) => {\n        setShow(!show);\n        setTarget(event.target);\n\n    };\n\n    return (\n        <Container fluid style={{ marginBottom: '50px' }}>\n            <Meta\n                title=\"Agrocare | Profile\"\n            />\n            <Row>\n                <Col md={3}>\n                    <h2 style={{ marginTop: '110px' }}>User Profile</h2>\n                    {message && <Message variant='danger'>{message}</Message>}\n                    {error && <Message variant='danger'>{error}</Message>}\n                    {success && <Message variant='success'>Profile Updated!</Message>}\n                    {loading && <Loader />}\n                    <Form onSubmit={submitHandler}>\n                        <Form.Group controlId='name'>\n                            <Form.Label>Name <span style={{ color: 'red' }}>*</span></Form.Label>\n                            <Form.Control\n                                type=\"name\"\n                                placeholder=\"Enter name\"\n                                value={name}\n                                required\n                                onChange={(e) => setName(e.target.value)}\n                            ></Form.Control>\n                        </Form.Group>\n                        <Form.Group controlId='email'>\n                            <Form.Label>Email Address / NIC <span style={{ color: 'red' }}>*</span></Form.Label>\n                            <Form.Control\n                                type=\"nic\"\n                                placeholder=\"Enter email or NIC\"\n                                value={email}\n                                required\n                                onChange={(e) => setEmail(e.target.value)}\n                            ></Form.Control>\n                        </Form.Group>\n                        <Form.Group controlId='cropSelection'>\n                            <Form.Label>Crop Selection (optional)</Form.Label>\n                            <Form.Control\n                                type=\"cropSelection\"\n                                placeholder=\"Enter cropSelection\"\n                                value={cropSelection}\n                                onChange={(e) => setCropSelection(e.target.value)}\n                            ></Form.Control>\n                        </Form.Group>\n                        <Form.Group controlId='password'>\n                            <Form.Label>Password</Form.Label>\n                            <Form.Control\n                                type=\"password\"\n                                placeholder=\"Enter password\"\n                                value={password}\n                                onChange={(e) => setPassword(e.target.value)}\n                            ></Form.Control>\n                        </Form.Group>\n                        <Form.Group controlId='confirmPassword'>\n                            <Form.Label>Confirm password</Form.Label>\n                            <Form.Control\n                                type=\"password\"\n                                placeholder=\"Confirm password\"\n                                value={confirmPassword}\n                                onChange={(e) => setConfirmPassword(e.target.value)}\n                            ></Form.Control>\n                        </Form.Group>\n                        <Button type=\"submit\" variant=\"primary\">Update</Button>\n                    </Form>\n                </Col>\n                <Col md={9}>\n                    <Scrollbar style={{ width: '100%', height: 630 }}>\n                        <Container fluid>\n                            <Row>\n                                <h2 style={{ marginTop: '110px' }}>My Orders</h2>\n                                {loadingOrders ? <Loader />\n                                    : errorOrders ? <Message variant=\"danger\">{errorOrders}</Message>\n                                        : (\n                                            <Table striped bordered hover responsive className=\"table-sm\">\n                                                <thead>\n                                                    <tr>\n                                                        <th>ID</th>\n                                                        <th>DATE</th>\n                                                        <th>TOTAL</th>\n                                                        <th>PAID</th>\n                                                        <th>DELIVERED</th>\n                                                        <th>MORE</th>\n                                                    </tr>\n                                                </thead>\n                                                <tbody>\n                                                    {orders.map(order => (\n                                                        <tr key={order._id}>\n                                                            <td>{order._id}</td>\n                                                            <td>{order.createdAt.substring(0, 10)}</td>\n                                                            <td>{order.totalPrice}</td>\n                                                            <td>{order.isPaid ? order.paidAt.substring(0, 10) :\n                                                                <i className=\"fas fa-times\" styles={{ color: \"red\" }}></i>\n                                                            }</td>\n                                                            <td>{order.isDelivered ? order.deliveredAt.substring(0, 10) :\n                                                                <i className=\"fas fa-times\" styles={{ color: 'red' }}></i>\n                                                            }</td>\n                                                            <td>\n                                                                <LinkContainer to={`/order/${order._id}`}>\n                                                                    <Button className=\"btn-sm\" variant=\"success\">Details</Button>\n                                                                </LinkContainer>\n                                                            </td>\n                                                        </tr>\n                                                    ))}\n                                                </tbody>\n                                            </Table>\n                                        )\n                                }\n                            </Row>\n                            <Row>\n                                <h2 style={{ marginTop: '110px' }}>My Products</h2>\n                                {loadingProducts ? <Loader />\n                                    : errorProducts ? <Message variant=\"danger\">{errorProducts}</Message>\n                                        : (\n                                            <Table striped bordered hover responsive className=\"table-sm\">\n                                                <thead>\n                                                    <tr>\n                                                        <th>NAME</th>\n                                                        <th>EMAIL/NIC</th>\n                                                        <th>ADDRESS</th>\n                                                        <th>IMAGE</th>\n                                                        <th>CROP</th>\n                                                        <th>REVIEWED</th>\n                                                        <th>EDIT</th>\n                                                    </tr>\n                                                </thead>\n                                                <tbody>\n                                                    {products.map(product => (\n                                                        <tr key={product._id}>\n                                                            <td>{product.name}</td>\n                                                            <td>{product.email}</td>\n                                                            <td>{product.address}</td>\n                                                            <td>\n                                                                <Image width={70} rounded src={product.image} />\n                                                            </td>\n                                                            <td>{product.cropSelection}</td>\n                                                            <td style={{ textAlign: \"center\" }}>\n                                                                {\n                                                                    product.isReviwed ? (\n                                                                        <Button\n                                                                            className=\"mt-2\"\n                                                                            ref={target}\n                                                                            onClick={handleClick}\n                                                                        > Check\n                                                                        </Button>\n                                                                    ) : <i className=\"fas fa-times\" style={{ color: 'red', fontSize: '24px' }}></i>\n                                                                }\n                                                                <Overlay\n                                                                    show={show}\n                                                                    target={target}\n                                                                    placement=\"bottom\"\n                                                                    container={ref.current}\n                                                                    containerPadding={10}\n                                                                >\n                                                                    <Popover id=\"popover-contained\">\n                                                                        <Popover.Title as=\"h3\">Rating: {product.rating}</Popover.Title>\n                                                                        {\n                                                                            product.reviews.map(review => (\n                                                                                <Popover.Content key={review._id}>\n                                                                                    <strong>Feedback: {review.comment}</strong>\n                                                                                </Popover.Content>\n                                                                            ))\n                                                                        }\n                                                                    </Popover>\n                                                                </Overlay>\n                                                            </td>\n                                                            <td>\n                                                                <LinkContainer to={`/supplierproducts/${product._id}/edit`}>\n                                                                    <Button variant=\"light\" className=\"btn btn-sm\">\n                                                                        <i className=\"fas fa-edit\"></i>\n                                                                    </Button>\n                                                                </LinkContainer>\n                                                            </td>\n                                                        </tr>\n                                                    ))}\n                                                </tbody>\n                                            </Table>\n                                        )\n                                }\n                            </Row>\n                        </Container>\n                    </Scrollbar>\n                </Col>\n            </Row>\n        </Container>\n    )\n}\n\nexport default ProfileScreen \n"]},"metadata":{},"sourceType":"module"}